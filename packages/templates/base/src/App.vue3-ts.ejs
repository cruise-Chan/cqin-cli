<template>
  <router-view v-slot="{ Component, route }">
    <component :is="route.meta.noLayout ? Component : MainLayout">
      <component :is="Component" />
    </component>
  </router-view>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import MainLayout from '@/layouts/MainLayout.vue'
import request  from '@/common/request'
request.use('request', {
  onFulfilled: (config) => {
    const token = localStorage.getItem('token')
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }
    return config
  }
})
// 添加响应拦截器（处理数据格式）
request.use('response', {
  onFulfilled: async (response) => {
    const data = await response.json()
    if (data.code !== 200) {
      throw new Error(data.message)
    }
    return data
  }
})
</script>

<style <% if (cssPreprocessor !== 'CSS') { %>lang="<%= styleLang %>"<% } %> scoped>
.app {
  color: #42b983;
}
.greeting {
  <% if (cssPreprocessor === 'Sass/SCSS') { %>
  &-text {
    color: blue;
  }
  <% } else { %>
  color: red;
  <% } %>
}
</style>